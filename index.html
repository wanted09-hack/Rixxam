<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Ayrix ‚Äì Live Sync Player</title>
  <link rel="manifest" href="manifest.json">
<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }
</script>
    <link rel="icon" type="image/png" sizes="192x192" href="icons/ayrix-icon-192.png">
  <link rel="apple-touch-icon" href="icons/ayrix-icon-192.png">
  <meta name="theme-color" content="#05000b">


  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
        * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 16px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #ff4da6 0, transparent 55%),
                  radial-gradient(circle at bottom, #7b5dff 0, transparent 55%),
                  #050515;
      min-height: 100vh;
      display: flex;
      align-items: center;       /* center vertically */
      justify-content: center;   /* center horizontally */
      color: #f8f2ff;
    }

    .app {
      width: 90%;
max-width: 600px;
      
margin: 0 auto;
      background: rgba(8, 6, 24, 0.96);
      border-radius: 24px;
      padding: 20px 18px;
      box-shadow:
        0 18px 45px rgba(0, 0, 0, 0.7),
        0 0 35px rgba(255, 77, 166, 0.55),
        0 0 60px rgba(123, 93, 255, 0.45);
      backdrop-filter: blur(18px);
    }

    h1 {
      margin: 0 0 6px;
      font-size: 1.5rem;
      text-align: center;
      letter-spacing: 0.03em;
    }

    .subtitle {
      text-align: center;
      font-size: 0.8rem;
      margin-bottom: 14px;
      opacity: 0.8;
    }

    #hostToggle {
      display: block;
      width: 100%;
      padding: 12px;
      border-radius: 999px;
      border: none;
      font-size: 0.9rem;
      margin-bottom: 10px;
      cursor: pointer;
      background: linear-gradient(90deg, #252047, #342a63);
      color: #f6ebff;
      transition: background 0.2s ease, transform 0.15s ease, box-shadow 0.15s ease;
      box-shadow: 0 0 0 rgba(0,0,0,0);
    }

    #hostToggle.host {
      background: linear-gradient(90deg, #ff4fa0, #ff7edb);
      color: #fff;
      box-shadow: 0 0 18px rgba(255, 79, 160, 0.7);
    }

    #hostToggle:active {
      transform: scale(0.98);
    }

    audio {
      width: 100%;
      margin: 12px 0 10px;
      filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.4));
    }

    #status {
      font-size: 0.78rem;
      text-align: center;
      margin-bottom: 8px;
      opacity: 0.9;
    }

    #songs {
      max-height: 390px;
      overflow-y: auto;
      margin-top: 10px;
      padding-right: 2px;
    }

    .song-button {
      width: 100%;
      padding: 10px 12px;
      margin-bottom: 8px;
      border-radius: 14px;
      border: none;
      text-align: left;
      font-size: 0.86rem;
      cursor: pointer;
      background: rgba(23, 18, 52, 0.95);
      color: #f7e9ff;
      transition: background 0.2s ease, transform 0.15s ease, box-shadow 0.15s ease;
      box-shadow: 0 0 0 rgba(0,0,0,0);
    }

    .song-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
    }

    .song-button.playing {
      background: linear-gradient(90deg, #ff4fa0, #7f5dff);
      color: #fff;
      box-shadow:
        0 0 14px rgba(255, 79, 160, 0.7),
        0 0 22px rgba(127, 93, 255, 0.6);
      transform: translateY(-1px) scale(1.01);
    }

    .song-button.playing::before {
      content: "‚óè ";
      color: #ffe9ff;
    }
    /* ===== Ayrix splash screen ===== */

#ayrix-splash {
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    background: radial-gradient(circle at top, #ff4fd8 0%, #2b0038 40%, #05000b 100%);
    animation: ayrixSplashIn 0.8s ease-out forwards;
}

#ayrix-splash.hide {
    animation: ayrixSplashOut 0.8s ease-in forwards;
}

.ayrix-splash-inner {
  text-align: center;
  padding: 24px;
}

.ayrix-splash-logo-wrap {
  display: inline-flex;
  padding: 14px;
  border-radius: 32px;
  background: rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(10px);
  box-shadow:
    0 0 25px rgba(255, 79, 216, 0.7),
    0 0 60px rgba(154, 92, 255, 0.6);
}

.ayrix-splash-logo {
  width: 72px;
  height: 72px;
  border-radius: 24px;
}

.ayrix-splash-title {
  margin-top: 10px;
  font-size: 1.1rem;
  font-weight: 700;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: #ffffff;
}

.ayrix-splash-subtitle {
  margin-top: 4px;
  font-size: 0.7rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: #ffd9fb;
  opacity: 0.9;
}

@keyframes ayrixSplashIn {
  0% { opacity: 0; transform: scale(1.05); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes ayrixSplashOut {
  0% { opacity: 1; transform: scale(1) translateY(0); }
  100% { opacity: 0; transform: scale(0.96) translateY(-18px); visibility: hidden; }
}

  </style>
</head>

<body>
  <!-- Ayrix opening splash -->
  <div id="ayrix-splash">
    <div class="ayrix-splash-inner">
      <div class="ayrix-splash-logo-wrap">
        <img src="icons/ayrix-icon-192.png" alt="Ayrix logo" class="ayrix-splash-logo">
      </div>
      <div class="ayrix-splash-title">AYRIX</div>
      <div class="ayrix-splash-subtitle">Stay synced, stay close ü§ç</div>
    </div>
  </div>
  
  <div class="app">
    ...
    <h1>Ayrix ‚Äì Live Sync Player</h1>
    <div class="subtitle">Ayrix by Aman, with luvv ‚Ä¢ Stay synced, stay close ü§ç</div>

    <button id="hostToggle">Become host</button>
    <div id="status">You are a listener. Wait for host to play a song.</div>

    <audio id="player" controls></audio>

    <div id="songs">Loading songs‚Ä¶</div>
  </div>

  <script>
  // Ayrix splash ‚Äì simple timer
  const splash = document.getElementById("ayrix-splash");
  if (splash) {
    // kitni der splash dikhana hai (ms)
    setTimeout(() => {
      splash.classList.add("hide");

      // exit animation khatam hote hi element hata do
      setTimeout(() => {
        splash.remove();
      }, 800); // ye value = CSS out animation duration se thodi zyada
    }, 2300); // 2.3 sec visible
  }
</script>



  <script type="module">
    // ====== GOOGLE DRIVE STREAM CONFIG ======
    const GOOGLE_API_KEY = "AIzaSyA06vHg4uelFoqLIs-dVBF_trQ7qBtR7TU";

    // ---------- SONG LIST (tumhare links) ----------
    const SONGS = [
      {
        name: "Kamin._Emin..ft_Jony_TikTok-Verson",
        url: "https://drive.google.com/uc?export=download&id=18D9apP7dukjGqDYxK3RepB9Hnp9hQwXV"
      },
      {
        name: "NUNCA_MUDA (Slowed)",
        url: "https://drive.google.com/uc?export=download&id=18ERIRL9IREhJPJHOGnLRX_HvKCliUEkO"
      },
      {
        name: "NUNCA_MUDA (Slowed 2)",
        url: "https://drive.google.com/uc?export=download&id=18LLjpJKOjsWSiJMhzFBZ28zxdWZ4cl9R"
      },
      {
        name: "MONTAGEM_LUNAR_DIAMANTE_2 (Slowed)",
        url: "https://drive.google.com/uc?export=download&id=18Nzk7PfqEoxXzN7IniXeYXn54h5J3Gc2"
      },
      {
        name: "Noga_Erez - DUMB",
        url: "https://drive.google.com/uc?export=download&id=18V-_oLHFJZK3nrqhElosZWwRuCEek_DF"
      },
      {
        name: "look_at_me (nomad remix)",
        url: "https://drive.google.com/uc?export=download&id=18bx3CK4TIgCGld0t4bl_rHdXM11skzIs"
      },
      {
        name: "The_Lost_Soul_Down_X_Lost_Soul",
        url: "https://drive.google.com/uc?export=download&id=18c12UomcXyJ1RuN_zzL6BBh32PrM9nm_"
      },
      {
        name: "Folki_Soul_Down (Slowed)",
        url: "https://drive.google.com/uc?export=download&id=18fQgpvMCsnM7_zMdpwS2swd4KrIDRp1d"
      },
      {
        name: "desolate (Slowed)",
        url: "https://drive.google.com/uc?export=download&id=18gln12KHD0BHILQnHmheGfm1tLRjGhxe"
      },
      {
        name: "kompa_parano,frozy__extend",
        url: "https://drive.google.com/uc?export=download&id=18huyjy1KlXOXPrwlVx68tbKi8dEjHrV2"
      },
      {
        name: "Shopping_List - Honey Singh",
        url: "https://drive.google.com/uc?export=download&id=18iM5ZCiW1OEHSByWSyEWS8x-DfPizj6N"
      },
      {
        name: "Wanted Aman - Recreated shit",
        url: "https://drive.google.com/uc?export=download&id=18jpOwY8gJ1X_b6ULOfcQTwu7_zcV0dHF"
      },
      {
        name: "rocKsun - MAHAAN",
        url: "https://drive.google.com/uc?export=download&id=18n4tPUgUVt20ZP576pDagXdUf4n7Z3uT"
      },
      {
        name: "You (Slowed + Reverb)",
        url: "https://drive.google.com/uc?export=download&id=18nvdf9Npd2zjVcqtTnrymlutCJUWxj20"
      },
      {
        name: "Bae I'm Back",
        url: "https://drive.google.com/uc?export=download&id=18rbicc7MLHiHABEwnojq3f7dlGdhpqeW"
      },
      {
        name: "Tyga - Adrenaline",
        url: "https://drive.google.com/uc?export=download&id=18tV3cVbAWrh59-vGKFudHyEtbdHipk8j"
      },
      {
        name: "MANIAC 2.0 Remix",
        url: "https://drive.google.com/uc?export=download&id=18uAUH6vmhM0FOkX_WrZJViehvBO9JNVR"
      },
      {
        name: "–ú–µ–¥—É–∑–∞ TikTok Remix",
        url: "https://drive.google.com/uc?export=download&id=18yoIZz1mkWlCN-yYVOv0Cx8ayT69z2AS"
      },
      {
        name: "La Fiesta - Sekiz",
        url: "https://drive.google.com/uc?export=download&id=191EzI8OHw7_q3mzcf03Yg9sRa6iOdOOF"
      },
      {
        name: "DJ FKU - VINGAN√áA 2",
        url: "https://drive.google.com/uc?export=download&id=191OsmQj29dQ_r6iJVWo4i9w8K4REzGOm"
      }
      // baaki songs bhi isi pattern me aage add kar sakta hai
    ];

    // Drive link -> streamable URL
    function toStreamUrl(driveUrl) {
      const match = driveUrl.match(/id=([^&]+)/);
      const fileId = match ? match[1] : driveUrl.trim();
      return `https://www.googleapis.com/drive/v3/files/${fileId}?alt=media&key=${GOOGLE_API_KEY}`;
    }

    // ---------- FIREBASE ----------
    import {initializeApp} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import {
      getDatabase,
      ref,
      onValue,
      update
    } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCWnQ02Wy3rM-gG8yVwfSJchRsO7aDrTcU",
      authDomain: "ritaxaman.firebaseapp.com",
      databaseURL: "https://ritaxaman-default-rtdb.firebaseio.com",
      projectId: "ritaxaman",
      storageBucket: "ritaxaman.firebasestorage.app",
      messagingSenderId: "559873885969",
      appId: "1:559873885969:web:e7a7b4fe3a3fc5b420aeb0",
      measurementId: "G-53Z6W1XTJS"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const sessionRef = ref(db, "sessions/ritaAman");

    // ---------- UI ELEMENTS ----------
    const audio = document.getElementById("player");
    const hostToggle = document.getElementById("hostToggle");
    const statusEl = document.getElementById("status");
    const songsContainer = document.getElementById("songs");

    let isHost = false;

    // ---------- HOST TOGGLE ----------
    hostToggle.addEventListener("click", () => {
      isHost = !isHost;
      if (isHost) {
        hostToggle.classList.add("host");
        hostToggle.textContent = "You are host ‚úÖ";
        statusEl.textContent =
          "You are host. Whatever you play will sync to connected devices.";
        sendState();
      } else {
        hostToggle.classList.remove("host");
        hostToggle.textContent = "Become host";
        statusEl.textContent =
          "You are a listener. Wait for host to play a song.";
      }
    });

    // ---------- SONG BUTTONS FROM SONGS ARRAY ----------
    function buildSongButtons() {
      if (!SONGS.length) {
        songsContainer.textContent = "No songs configured.";
        return;
      }
      songsContainer.innerHTML = "";
      SONGS.forEach((song, index) => {
        const btn = document.createElement("button");
        btn.className = "song-button";
        btn.textContent = (index + 1) + ". " + song.name;
        btn.dataset.url = song.url; // original drive url

        btn.addEventListener("click", () => {
          if (!isHost) {
            alert("Only host can select songs. Tap 'Become host' on your phone.");
            return;
          }
          const streamUrl = toStreamUrl(song.url);
          playAsHost(streamUrl);
          highlightPlaying(streamUrl);
        });

        songsContainer.appendChild(btn);
      });
    }

    function highlightPlaying(url) {
      const buttons = songsContainer.querySelectorAll(".song-button");
      buttons.forEach((b) => {
        const streamForButton = toStreamUrl(b.dataset.url);
        if (streamForButton === url) {
          b.classList.add("playing");
        } else {
          b.classList.remove("playing");
        }
      });
    }

    // ---------- HOST: SEND STATE ----------
    function sendState() {
      if (!isHost) return;
      update(sessionRef, {
        songUrl: audio.src || "",
        isPlaying: !audio.paused,
        position: audio.currentTime || 0,
        updatedAt: Date.now()
      }).catch((e) => console.error("sendState error:", e));
    }

    async function playAsHost(url) {
      if (!isHost) return;
      audio.src = url;
      audio.currentTime = 0;
      try {
        await audio.play();
      } catch (e) {
        console.error("Playback error:", e);
      }
      sendState();
    }

    audio.addEventListener("play", () => sendState());
    audio.addEventListener("pause", () => sendState());
    audio.addEventListener("seeked", () => sendState());
    audio.addEventListener("ended", () => sendState());

    // ---------- LISTENER: RECEIVE STATE ----------
    onValue(sessionRef, async (snapshot) => {
      const data = snapshot.val();
      if (!data) return;

      const {songUrl, isPlaying, position} = data;

      if (isHost) return; // host ignore kare

      if (songUrl && audio.src !== songUrl) {
        audio.src = songUrl;
        highlightPlaying(songUrl);
      }

      if (Math.abs(audio.currentTime - position) > 1) {
        audio.currentTime = position;
      }

      if (isPlaying && audio.paused) {
        audio.play().catch(() => { });
      } else if (!isPlaying && !audio.paused) {
        audio.pause();
      }

      statusEl.textContent = "Listening with host‚Ä¶ üéß";
    });

    // ---------- START ----------
    buildSongButtons();
  </script>
</body>

</html> 
